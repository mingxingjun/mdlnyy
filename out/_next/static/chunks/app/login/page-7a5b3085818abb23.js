(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{19825:()=>{},30748:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var a=r(95155),o=r(12115),l=r(77644),s=r(35695),i=r(43463);function n(){let[e,t]=(0,o.useState)(""),[r,n]=(0,o.useState)(""),[d,u]=(0,o.useState)(""),[c,m]=(0,o.useState)(!1),{login:g}=(0,l.A)(),p=(0,s.useRouter)(),h=async t=>{t.preventDefault(),u(""),m(!0);try{let t=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),a=await t.json();if(!t.ok)throw Error(a.error||"登录失败，请检查邮箱和密码");g(a.token,a.user),p.push("/")}catch(e){u(e instanceof Error?e.message:"发生未知错误")}finally{m(!1)}};return(0,a.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-md p-8 space-y-6 bg-white dark:bg-gray-800 rounded-xl shadow-md",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"欢迎回来"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"请登录您的账户"})]}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[d&&(0,a.jsx)("div",{className:"p-3 text-sm text-red-800 bg-red-100 dark:bg-red-900 dark:text-red-200 rounded-lg",children:d}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"邮箱"}),(0,a.jsx)("input",{id:"email",type:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"w-full px-4 py-2 mt-1 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white",placeholder:"your.email@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"密码"}),(0,a.jsx)("input",{id:"password",type:"password",required:!0,value:r,onChange:e=>n(e.target.value),className:"w-full px-4 py-2 mt-1 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white",placeholder:"••••••••"})]}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"w-full px-4 py-3 font-medium text-white bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50",children:c?"登录中...":"登录"})]})]})}},38188:(e,t,r)=>{Promise.resolve().then(r.bind(r,30748))},77644:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>d,A:()=>u});var a=r(95155),o=r(12115),l=r(58801),s=r.n(l);r(57599);let i=r(49509).env.JWT_SECRET||"your-secret-key",n=(0,o.createContext)(void 0);function d(e){let{children:t}=e,[r,l]=(0,o.useState)(null),[d,u]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{try{let e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&t&&(s().verify(e,i),l(JSON.parse(t)))}catch(e){console.error("验证token失败:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}finally{u(!1)}},[]),(0,a.jsx)(n.Provider,{value:{user:r,loading:d,login:(e,t)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(t)),l(t)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),l(null)},isAuthenticated:!!r},children:t})}let u=()=>{let e=(0,o.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}},e=>{e.O(0,[268,463,134,877,441,964,358],()=>e(e.s=38188)),_N_E=e.O()}]);